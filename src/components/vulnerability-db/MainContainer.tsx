"use client";

import { useEffect, useState } from "react";
import ArticleList from "@/components/vulnerability-db/ArticleList";
import RealTimeTopic from "@/components/vulnerability-db/RealTimeTopic";
import Pagination from "@/components/vulnerability-db/Pagination";
import { ArticleDataList, TArticleListItem } from "./dummydata";

/**
 * @description `MainContainer` 컴포넌트는 기사 목록과 실시간 주제를 표시하는 메인 컨테이너 역할을 합니다.
 * 페이지네이션 기능을 포함하고 있으며, 페이지 변경 시 해당 페이지에 맞는 데이터를 표시합니다.
 *
 * @returns {JSX.Element} 메인 컨테이너를 렌더링하는 컴포넌트입니다.
 *
 * @todo
 * - data 값을 보고 재구성
 * - 아직 오른쪽 화살표 버튼 누르면 10개씩 넘어가게 구성 X
 */

/**
 * @description `TListData`는 리스트 데이터와 전체 길이를 포함하는 타입입니다.
 *
 * @typedef {Object} TListData
 * @property {TArticleListItem[]} data - 현재 페이지에 표시될 기사 목록 데이터.
 * @property {number} length - 전체 기사 목록의 길이.
 */

type TListData = {
  data: TArticleListItem[];
  length: number;
};

function MainContainer(): JSX.Element {
  // filtering 한 데이터 입니다.
  const [listData, setListData] = useState<TListData>({ data: [], length: 0 });
  const [page, setPage] = useState(1);
  const perPage = 5;
  const totalPage = Math.ceil(ArticleDataList.length / perPage);

  useEffect(() => {
    // dummydata에서 filtering 해주고 있습니다.
    const getData = () => {
      let res = ArticleDataList.filter(
        (item) =>
          item.id >= perPage * page - perPage && item.id <= perPage * page - 1,
      );
      setListData({ data: res, length: ArticleDataList.length });
    };
    getData();
  }, [page]);

  return (
    <>
      <div className="flex h-[1350px] justify-between">
        <ArticleList listData={listData.data} />
        <RealTimeTopic />
      </div>
      <Pagination
        page={page}
        setPage={setPage}
        limit={10}
        totalPage={totalPage}
      />
    </>
  );
}
export default MainContainer;
